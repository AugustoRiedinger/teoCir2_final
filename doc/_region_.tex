\message{ !name(../main.tex)}\documentclass[journal,transmag]{IEEEtran}

% Document preamble - loads packages
\input{../config/preamble}
% Document settings
\input{../config/settings}

\begin{document}

\message{ !name(sections/03-01-ellip.tex) !offset(-10) }
\subsection{Diseño de un filtro elíptico FFIR}
    Se ilustrará a continuación un filtro pasa-bajos de fase lineal FFIR
    utilizando la técnica de diseño de magnitud cuadarada como se desarrolló en
    la Sec. \ref{sec:02-02-mag-cuad}. Entonces, se deseará que el filtro cumpla
    con los siguientes criterios de diseño


    \begin{enumerate}
      \item Banda de paso normalizada $(0.00,0.10)$ en fracciones de
            $\nicefrac{f_{s}}{2}$ con al menos $0.08 \: [\unit{dB}]$ de ripple
            máximo pico-a-pico, donde $f_{s}$ se define como la frecuencia de
            muestreo.
      \item Banda de parada normalzada $(0.11,1.00)$ con al menos
            $50 \: [\unit{dB}]$ de atenuación.
      \item Fase lineal.
      \item Amplitud máxima de $\mu = 1.0$.

    \end{enumerate}

    Debido a la banda de transición angosta en el intervalo $(0.10,0.11)$, se
    selecciona un filtro elíptico como la base del diseño. Luego, 3) será
    irrelevante ya que un filtro FIR basado en la metodología TIIR (FFIR) tendrá
    las características intrínsecas de fase lineal. De esta forma, como
    observa en el algoritmo que se muestra a continuación, se pueden ingresar
    los parámetros del filtro en GNU Octave y mediante la función
    \lstinline|ellip| se obtendrán los coefientes del filtro

    \lstinputlisting[language=Octave]{../code/ellip-coeffs.m}

    \begin{itemize}
      \item $a_{0} = 1.0000$
      \item $a_{1} = -5.2007$
      \item $a_{2} = 11.4639$
      \item $a_{3} = -13.6841$
      \item $a_{4} = 9.3190$
      \item $a_{5} = -3.4305$
      \item $a_{6} = 0.5332$
    \end{itemize}

    \begin{itemize}
      \item $b_{0} = 0.051513$
      \item $b_{1} = -0.257151$
      \item $b_{2} = 0.576634$
      \item $b_{3} = -0.741252$
      \item $b_{4} = 0.576634$
      \item $b_{5} = -0.257151$
      \item $b_{6} = 0.051513$
    \end{itemize}

     Como la multiplicidad de cada polo es uno, se puede utilizar la forma dada
     en la Ec. \ref{eq:73} para calcular los vaores de $N_{k}$, y se redondedea
     en cada caso. Los polos se dan en la TABLA XXXXX, como la magnitud y los
     $N_{k}$ para cada polo. Como los coeficientes se encuentran en forma
     de pares complejos conjugados, se puede reescribir $H(z)$ en tres terminos
     reales de segundo orden tal que

     \begin{equation}
       \begin{aligned}
         H(z) = h_{0} +& \frac{b_{1,1} \: z^{-1} + b_{1,2} \: z^{-2}}{1 + a_{1,1} \: z^{-1} + a_{1,2} \: z^{-2}} +\\
         +& \frac{b_{2,1} \: z^{-1} + b_{2,2} \: z^{-2}}{1 + a_{2,1} \: z^{-1} + a_{2,2} \: z^{-2}} + \\
         +& \frac{b_{3,1} \: z^{-1} + b_{3,2} \: z^{-2}}{1 + a_{3,1} \: z^{-1} + a_{3,2} \: z^{-2}}
       \end{aligned}
     \end{equation}

     donde los coeficientes se dan en la TABLA XXXX. Sin embargo, se deberá
     adaptar la función transferencia para poder implementar la misma a través
     de GNU Octave. Esto es, si se asocia
     $H(z) = h_{0} + H_{1}(z) + H_{2}(z) + H_{3}(z)$, se desarrollará la
     reformulación de $H_{1}(z)$ teniendo en cuenta que $H_{2,3}(z)$ será
     similares pero con diferentes coeficientes

     \begin{equation}
       \begin{aligned}
         H_{1}(z) =& \frac{b_{1,1} \: z^{-1} + b_{1,2} \: z^{-2}}{1 + a_{1,1} \: z^{-1} + a_{1,2} \: z^{-2}} \\
         =& \frac{z^{-2} \left( b_{1,1} \: z + b_{1,2} \right)}{1 + z^{-2} \left( a_{1,1} \: z + a_{1,2} \right)} \\
         =& \frac{b_{1,1} \: z + b_{1,2}}{z^{2} \: \left[1 + z^{-2} \left( a_{1,1} \: z + a_{1,2} \right) \right]} \\
         =& \frac{b_{1,1} \: z + b_{1,2}}{z^{2} + a_{1,1} \: z + a_{1,2}}
       \end{aligned}
     \end{equation}

     Entonces, finalmente $H(z)$ se puede escribir como

     \begin{equation}
       \begin{aligned}
       H(z) = h_{0} +& \frac{b_{1,1} \: z + b_{1,2}}{z^{2} + a_{1,1} \: z + a_{1,2}} +
       \frac{b_{2,1} \: z + b_{2,2}}{z^{2} + a_{2,1} \: z + a_{2,2}} + \\
       +& \frac{b_{3,1} \: z + b_{1,2}}{z^{2} + a_{3,1} \: z + a_{3,2}}
       \end{aligned}
     \end{equation}

     Se implementa cada termino de forma separada en la forma truncada dada en la
     Ec. \ref{eq:25} para formar $H_{FIR}^{+}(z)$, utilizando los $N_{1,3,5}$ de
     cada término para los cortes. Los coeficientes son calculados utilizando
     nuevamente la técnica de división sintética, y también se muestran en la
     TABLA XXXX. Se elige $N = 497$ como el punto de corte para truncar el
     filtro, ya que dicho $N_{k}$ es el más grande. Asi, se implementa el filtro

     \begin{widetext}
     \begin{equation}
      \begin{aligned}
        H_{FIR}^{+}(z) = h_{0} +&
        \frac{b_{1,1} \: z^{-1} + b_{1,2} \: z^{-2} - b_{1,1}^{\prime} \: z^{-(N_{1}+1)} - b_{1,2}^{\prime} \: z^{-(N_{1+2})}}{1 + a_{1,1} \: z^{-1} + a_{1,2} \: z^{-2}} \\
        +& \frac{b_{2,1} \: z^{-1} + b_{2,2} \: z^{-2} - b_{2,1}^{\prime} \: z^{-(N_{1}+1)} - b_{2,2}^{\prime} \: z^{-(N_{1+2})}}{1 + a_{2,1} \: z^{-1} + a_{2,2} \: z^{-2}} \\
        +& \frac{b_{3,1} \: z^{-1} + b_{3,2} \: z^{-2} - b_{3,1}^{\prime} \: z^{-(N_{1}+1)} - b_{3,2}^{\prime} \: z^{-(N_{1+2})}}{1 + a_{3,1} \: z^{-1} + a_{3,2} \: z^{-2}}
      \end{aligned}
     \end{equation}
     \end{widetext}

%%% Local Variables:
%%% mode: latex
%%% TeX-master: "../main"
%%% End:

\message{ !name(../main.tex) !offset(-105) }

\end{document}
